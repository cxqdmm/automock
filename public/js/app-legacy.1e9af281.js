(function(){var t={7249:function(t,e,n){"use strict";var a=n(9014),i=n.n(a),o=n(736),s=n.n(o),r=n(3329),l=n.n(r),c=n(3280),u=n.n(c),d=n(2331),f=n.n(d),h=n(2319),p=n.n(h),m=n(2245),v=n.n(m),b=n(6668),y=n.n(b),w=n(4412),g=n.n(w),C=n(7349),_=n.n(C),k=n(4863),x=n.n(k),j=n(8782),D=n.n(j),S=n(1192),R=n.n(S),O=n(4400),A=n.n(O),E=n(8807),T=n.n(E),V=n(2711),$=n.n(V),Z=(n(6992),n(8674),n(9601),n(7727),n(8309),n(8935)),N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("List")],1)},M=[],Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list"},[n("div",{staticClass:"list-head"},[n("div",{staticClass:"list-head-search"},[n("div",{staticClass:"list-head-item"},[n("span",{staticClass:"list-head-item-label"},[t._v("规则")]),n("el-select",{staticClass:"list-head-item",attrs:{placeholder:"请选择关联的pattern"},on:{change:t.searchApi},model:{value:t.search.rule,callback:function(e){t.$set(t.search,"rule",e)},expression:"search.rule"}},t._l(t.activeRules,(function(t){return n("el-option",{key:t.name,attrs:{label:t.name,value:t.value}})})),1)],1),n("el-input",{staticClass:"list-head-item list-head-name",attrs:{clearable:"",placeholder:"接口名模糊匹配"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchApi.apply(null,arguments)}},model:{value:t.search.name,callback:function(e){t.$set(t.search,"name",e)},expression:"search.name"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.searchApi},slot:"append"})],1)],1),n("div",{staticClass:"list-head-action"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleCreate}},[t._v("新建")]),n("el-divider",{attrs:{direction:"vertical"}}),t.search.onlymock?n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:t.batchDelete}},[t._v("清空mock")]):n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:t.batchDelete}},[t._v("清空非mock项")]),n("el-divider",{attrs:{direction:"vertical"}}),n("el-switch",{attrs:{"active-text":"显示mock","inactive-text":"","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:t.searchApi},model:{value:t.search.onlymock,callback:function(e){t.$set(t.search,"onlymock",e)},expression:"search.onlymock"}})],1)]),n("div",{staticClass:"container"},[n("div",{staticClass:"list-body",class:{"show-detail":!!t.currentRow}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,"highlight-current-row":"",height:"800",border:"",size:"mini","row-key":"name"},on:{"current-change":t.handleSelectRow}},[n("el-table-column",{attrs:{prop:"name",label:"文件名","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"name"},[n("div",{staticClass:"name-value font-bold",class:{blue:e.row.mock}},[t._v(" "+t._s(e.row.name)+" ")])])]}}])}),n("el-table-column",{attrs:{width:"100",label:"mock模式"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{staticClass:"name-tag font-bold",attrs:{effect:"dark",size:"mini",type:"success"}},[t._v(t._s(e.row.ruleValue))])]}}])}),n("el-table-column",{attrs:{prop:"rule","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.rule?n("div",{staticClass:"no-wrap line-height-1 blue font-bold flex align-center"},[n("span",{staticClass:"table-label"},[t._v("rule：")]),n("div",{staticClass:"flex-1"},[t._v(t._s(e.row.rule))])]):t._e(),e.row.url?n("div",{staticClass:"no-wrap line-height-1 font-bold flex align-baseline"},[n("span",{staticClass:"table-label"},[t._v("url：")]),n("span",{staticClass:"flex-1"},[t._v(t._s(e.row.url))])]):t._e()]}}])},[n("template",{slot:"header"},[t._v(" 接口信息 "),n("el-tooltip",{attrs:{effect:"light",content:"最近一次匹配的接口信息",placement:"top"}},[n("i",{staticClass:"el-icon-info"})])],1)],2),n("el-table-column",{attrs:{prop:"mockTime",width:"140"}},[n("template",{slot:"header"},[t._v(" mock时间 "),n("el-tooltip",{attrs:{effect:"light",content:"最近一次mock接口的时间",placement:"top"}},[n("i",{staticClass:"el-icon-info"})])],1)],2),n("el-table-column",{attrs:{prop:"updateTime",width:"140"}},[n("template",{slot:"header"},[t._v(" 更新时间 "),n("el-tooltip",{attrs:{effect:"light",content:"文件最近一次更新的时间",placement:"top"}},[n("i",{staticClass:"el-icon-info"})])],1)],2),n("el-table-column",{attrs:{width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{input:function(n){return t.updateMock(n,e.row)}},model:{value:e.row.mock,callback:function(n){t.$set(e.row,"mock",n)},expression:"scope.row.mock"}})]}}])},[n("template",{slot:"header"},[t._v(" mock "),n("el-tooltip",{attrs:{effect:"light",content:"开启mock后，文件内容只能通过手动编辑修改",placement:"top"}},[n("i",{staticClass:"el-icon-info"})])],1)],2),n("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return n.stopPropagation(),t.handleEdit(e.row)}}},[t._v(" 编辑 ")]),n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){return n.stopPropagation(),t.deleteApi(e.row,e.$index)}}},[t._v(" 删除 ")])]}}])})],1)],1),t.currentRow?n("div",{staticClass:"detail"},[n("i",{staticClass:"el-icon-close",on:{click:t.closeDetail}}),n("el-tabs",{attrs:{type:"border-card"}},[n("el-tab-pane",{attrs:{label:"详细信息"}},[n("div",{staticClass:"detail-item"},[n("div",{staticClass:"label"},[t._v("文件名")]),n("div",{staticClass:"value"},[t._v(t._s(t.currentRow.name))])]),n("div",{staticClass:"detail-item"},[n("div",{staticClass:"label"},[t._v("url")]),n("div",{staticClass:"value"},[t._v(t._s(t.currentRow.url))])]),n("div",{staticClass:"detail-item"},[n("div",{staticClass:"label"},[t._v("rule")]),n("div",{staticClass:"value"},[t._v(t._s(t.currentRow.rule))])]),n("div",{staticClass:"detail-item"},[n("div",{staticClass:"label"},[t._v("updateTime")]),n("div",{staticClass:"value"},[t._v(t._s(t.currentRow.updateTime))])])]),n("el-tab-pane",{attrs:{label:"query"}},t._l(Object.keys(t.currentRow.query||{}),(function(e){return n("div",{key:e,staticClass:"detail-item"},[n("div",{staticClass:"label"},[t._v(t._s(e))]),n("div",{staticClass:"value"},[t._v(t._s(t.currentRow.query[e]))])])})),0),n("el-tab-pane",{attrs:{label:"payload"}},[n("code-editor",{ref:"edit",attrs:{"show-btns":!1,"expanded-on-start":!0,mode:"code",lang:"zh"},model:{value:t.currentRow.payload,callback:function(e){t.$set(t.currentRow,"payload",e)},expression:"currentRow.payload"}})],1)],1)],1):t._e()]),n("div",{staticClass:"list-footer"}),n("api-window",{attrs:{"is-edit":t.editData.isEdit,visible:t.editData.visible,data:t.editData},on:{close:t.hideApiWindow,confirm:t.handleConfirm}})],1)},z=[],L=n(3019),J=n(8932);n(7327),n(1539),n(4747),n(1249),n(561),n(4916),n(4765),n(8862);function U(t){return fetch("/cgi-bin/api-list",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))}function B(){return fetch("/cgi-bin/check-api-list").then((function(t){return t.json()}))}function H(){return fetch("/cgi-bin/init?_="+Date.now(),{method:"get",referrer:location.origin}).then((function(t){return t.json()}))}function P(t,e){return fetch("/cgi-bin/update-api-data",{method:"post",body:JSON.stringify({name:t,data:e}),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))}function I(t){return fetch("/cgi-bin/create-api-data",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))}function q(t,e){return fetch("/cgi-bin/update-api-mock",{method:"post",body:JSON.stringify({name:t,mock:e}),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))}function W(t){return fetch("/cgi-bin/delete-api",{method:"post",body:JSON.stringify({name:t}),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))}function F(t){return fetch("/cgi-bin/batch-delete-api",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()}))}var G=n(3189),K=n.n(G),Q=n(2371),X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"dialog",attrs:{title:t.isEdit?"编辑":"新建",fullscreen:"",visible:t.visible,width:"1000px","before-close":t.close}},[n("div",{staticClass:"item"},[n("span",{staticClass:"item-label"},[t._v(" 模式: ")]),n("el-radio-group",{attrs:{disabled:t.isEdit},model:{value:t.ruleValue,callback:function(e){t.ruleValue=e},expression:"ruleValue"}},[n("el-radio",{attrs:{label:"pathname"}},[t._v("pathname")]),n("el-radio",{attrs:{label:"href"}},[t._v("href")])],1)],1),t.isEdit?n("div",{staticClass:"item"},[n("span",{staticClass:"item-label"},[t._v(" 名称: ")]),n("div",{staticClass:"item-value"},[t._v(t._s(t.name))])]):n("div",{staticClass:"item"},[n("span",{staticClass:"item-label"},[t._v(" 名称: ")]),n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入url",disabled:t.isEdit},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),n("div",{staticClass:"editor"},[n("span",{staticClass:"item-label"},[t._v(" 内容: ")]),n("code-editor",{ref:"edit",attrs:{"show-btns":!1,"expanded-on-start":!0,mode:"code",lang:"zh"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.close}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)])},tt=[],et=n(5200),nt=(n(8783),n(3948),n(285),n(1637),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"json-editor"},[n("div",{staticClass:"jsoneditor-vue"}),!1!==t.showBtns?n("div",{staticClass:"jsoneditor-btns"},[n("button",{staticClass:"json-save-btn",attrs:{type:"button",disabled:t.error},on:{click:function(e){return t.onSave()}}},[t._v(" "+t._s(t.locale[t.lang].save)+" ")])]):t._e()])}),at=[],it=n(7906),ot=n(6198),st=(n(9653),n(5056)),rt=n.n(st),lt={props:{value:[String,Number,Object,Array],showBtns:[Boolean],expandedOnStart:{type:Boolean,default:!1},mode:{type:String,default:"tree"},modes:{type:Array,default:function(){return["tree","code","text","view"]}},lang:{type:String,default:"en"}},data:function(){return{editor:null,error:!1,json:this.value,internalChange:!1,locale:{it:{save:"SALVA"},en:{save:"SAVE"},zh:{save:"保存"}}}},watch:{value:{immediate:!0,handler:function(t){var e=this;return(0,ot.Z)((0,it.Z)().mark((function n(){return(0,it.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.internalChange){n.next=4;break}return n.next=3,e.setEditor(t);case 3:e.error=!1;case 4:case"end":return n.stop()}}),n)})))()},deep:!0}},mounted:function(){var t=this,e={mode:this.mode,modes:this.modes,onChange:function(){try{var e=t.editor.get();t.json=e,t.error=!1,t.$emit("json-change",e),t.internalChange=!0,t.$emit("input",e),t.$nextTick((function(){t.internalChange=!1}))}catch(n){t.error=!0,t.$emit("has-error",n)}},onModeChange:function(){}};this.editor=new(rt())(this.$el.querySelector(".jsoneditor-vue"),e,this.json)},methods:{onSave:function(){this.$emit("json-save",this.json)},setEditor:function(t){var e=this;return(0,ot.Z)((0,it.Z)().mark((function n(){return(0,it.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.editor&&e.editor.set(t);case 1:case"end":return n.stop()}}),n)})))()}}},ct=lt,ut=n(1001),dt=(0,ut.Z)(ct,nt,at,!1,null,"2d467e86",null),ft=dt.exports,ht={props:{isEdit:{type:Boolean,default:!1},data:{type:Object,deafult:{}},visible:{type:Boolean,default:!1}},components:{"code-editor":ft},data:function(){return{content:{},name:"",ruleValue:"pathname"}},watch:{visible:function(t){t&&(this.content=this.data.content,this.ruleValue=this.data.ruleValue||"pathname",this.name=this.data.name)}},methods:{close:function(){this.$emit("close")},validate:function(){try{var t=new URL(this.name);return t.protocol?t.host?t.pathname?[!0]:[!1,"pathname不能为空"]:[!1,"host不能为空"]:[!1,"协议不能为空"]}catch(e){return[!1,"new URL() 无法解析出名称，请检查"]}},getName:function(){var t=new URL(this.name);return"pathname"===this.ruleValue?t.origin+t.pathname:"href"===this.ruleValue?t.href:void 0},confirm:function(){var t=this.validate(),e=(0,et.Z)(t,2),n=e[0],a=e[1];if(!n)return _().error(a);this.$emit("confirm",{content:this.content,name:this.getName(),ruleValue:this.ruleValue})}}},pt=ht,mt=(0,ut.Z)(pt,X,tt,!1,null,"53726c16",null),vt=mt.exports,bt={name:"api-list",components:{"api-window":vt,"code-editor":ft},mounted:function(){this.searchApi(),this.autoUpdateList(),this.getInit(),document.addEventListener("visibilitychange",this.visibleChange)},data:function(){return{search:{name:"",rule:"",onlymock:!1},list:[],activeRules:[{name:"全部",value:""}],view:{},editRow:null,editData:{visible:!1,isEdit:!1,content:{},name:"",ruleValue:""},currentRow:null}},beforeDestroy:function(){document.removeEventListener("visibilitychange",this.visibleChange)},computed:{lockAutoUpdate:function(){return!!this.editData.visible}},methods:{visibleChange:function(){this.pageShow()},closeDetail:function(){this.currentRow=null},getInit:function(){var t=this;H().then((function(e){var n=e.rules;t.getRules(n)}))},getRules:function(t){var e,n=t.defaultRules,a=t.defaultRulesIsDisabled,i=t.list,o=[];o=a?[]:(0,Q._)(n);var s=[],r=i.filter((function(t){return t.selected}));r.length&&r.forEach((function(t){var e=(0,Q._)(t.data);s.push.apply(s,(0,J.Z)(e))})),(e=o).push.apply(e,s),this.activeRules=o.map((function(t){return{name:t,value:t}})),this.activeRules.unshift({name:"全部",value:""})},pageShow:function(){"visible"===document.visibilityState&&(this.searchApi(),this.getInit())},handleSelectRow:function(t){this.currentRow=t},autoUpdateList:function(){var t=this;setInterval((function(){B().then((function(e){var n=e.code,a=e.data;200===n&&a&&(t.lockAutoUpdate||t.searchApi())}))}),2e3)},handleEdit:function(t){try{this.editData.content="string"===typeof t.data?JSON.parse(t.data):t.data,this.editRow=t,this.editData.name=t.name,this.editData.ruleValue=t.ruleValue,this.editData.isEdit=!0,this.editData.visible=!0}catch(e){_().error(e.message)}},hideApiWindow:function(){this.editData.visible=!1},handleConfirm:function(t){var e=t.content,n=t.name,a=t.ruleValue;this.editData.content=e,this.editData.name=n,this.editData.ruleValue=a,this.editData.isEdit?this.updateApiData({name:n,content:e}):this.createApi({name:n,content:e,ruleValue:a})},handleCreate:function(){this.editData.isEdit=!1,this.editData.content={},this.editData.name="",this.editData.visible=!0},createApi:function(t){var e=this;I(t).then((function(t){var n=t.code,a=t.msg;200!==n?_().error(a||"新建失败"):(_().success("新建成功"),e.hideApiWindow(),e.searchApi())})).catch((function(t){_().error(t.message||"更新失败")}))},updateApiData:function(t){var e=this,n=t.name,a=t.content;P(n,a).then((function(t){var n=t.code,a=t.data;if(200!==n)_().error("更新失败");else{var i=JSON.parse(a.data);e.editRow.time=i.time,e.editRow.data=i.data,e.editRow.updateTime=K()(i.time).format("YYYY-MM-DD HH:mm:ss"),_().success("更新成功"),e.hideApiWindow()}})).catch((function(){_().error("更新失败")}))},updateMock:function(t,e){q(e.name,t).then((function(t){200!==t.code?_().error("更新失败"):_().success("更新成功")})).catch((function(){_().error("更新失败")}))},deleteApi:function(t,e){var n=this;W(t.name).then((function(t){200!==t.code?_().error("删除失败"):(_().success("删除成功"),n.list.splice(e,1))})).catch((function(){_().error("删除失败")}))},batchDelete:function(){var t=this;F(this.search).then((function(e){200!==e.code?_().error("删除失败"):(_().success("删除成功"),t.searchApi())})).catch((function(){_().error("删除失败")}))},searchApi:function(){var t=this;U(this.search).then((function(e){var n=e||{},a=n.code,i=n.data;if(200===a){var o=(i||[]).map((function(t){try{return(0,L.Z)((0,L.Z)({},t),{},{expandUrl:!1,expandName:!1,payload:t.payload&&JSON.parse(t.payload)||{},updateTime:K()(t.time).format("YYYY-MM-DD HH:mm:ss"),mockTime:t.mockTime?K()(t.mockTime).format("YYYY-MM-DD HH:mm:ss"):""})}catch(e){return t}}));t.list=o}else _().error("列表请求失败")})).catch((function(t){_().error(t)}))}}},yt=bt,wt=(0,ut.Z)(yt,Y,z,!1,null,"d879dfa2",null),gt=wt.exports,Ct={name:"App",components:{List:gt}},_t=Ct,kt=(0,ut.Z)(_t,N,M,!1,null,null,null),xt=kt.exports;Z["default"].component($().name,$()),Z["default"].component(T().name,T()),Z["default"].component(A().name,A()),Z["default"].component(R().name,R()),Z["default"].component(D().name,D()),Z["default"].component(x().name,x()),Z["default"].component(_().name,_()),Z["default"].component(g().name,g()),Z["default"].component(y().name,y()),Z["default"].component(v().name,v()),Z["default"].component(p().name,p()),Z["default"].component(f().name,f()),Z["default"].component(u().name,u()),Z["default"].component(l().name,l()),Z["default"].component(s().name,s()),Z["default"].component(i().name,i()),Z["default"].config.productionTip=!1,new Z["default"]({render:function(t){return t(xt)}}).$mount("#app")},2371:function(t,e,n){n(1249),n(7327),n(1539),n(4916),n(3123),n(3210),n(5306),e._=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.split("\n").map((function(t){return t.trim()})).filter((function(t){return"#"!==t[0]})).filter((function(t){return~t.indexOf("automock://")})).map((function(t){return t.trim()})).map((function(t){return t.replace(/\s+/," ")}))}}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=t,function(){var t=[];n.O=function(e,a,i,o){if(!a){var s=1/0;for(u=0;u<t.length;u++){a=t[u][0],i=t[u][1],o=t[u][2];for(var r=!0,l=0;l<a.length;l++)(!1&o||s>=o)&&Object.keys(n.O).every((function(t){return n.O[t](a[l])}))?a.splice(l--,1):(r=!1,o<s&&(s=o));if(r){t.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[a,i,o]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,o,s=a[0],r=a[1],l=a[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(l)var u=l(n)}for(e&&e(a);c<s.length;c++)o=s[c],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},a=self["webpackChunkweb"]=self["webpackChunkweb"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(7249)}));a=n.O(a)})();